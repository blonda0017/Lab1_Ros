<launch>
    <!-- Аргументы -->
    <arg name="model" default="burger"/>
    <arg name="rviz" default="true"/>
    
    <!-- Запуск симуляции -->
    <include file="$(find super_blonda_study_pkg)/launch/turtlebot3_sim_start.launch">
        <arg name="model" value="$(arg model)" />
        <arg name="rviz" value="false" />
    </include>

    <!-- Запуск Hector SLAM -->
    <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">
        <remap from="scan" to="scan"/>
        
        <!-- Базовые параметры -->
        <param name="map_frame" value="map" />
        <param name="base_frame" value="base_footprint" />
        <param name="odom_frame" value="odom" />
        
        <!-- Параметры карты -->
        <param name="map_resolution" value="0.05" />
        <param name="map_size" value="2048" />
        <param name="map_start_x" value="0.5" />
        <param name="map_start_y" value="0.5" />
        <param name="map_multi_res_levels" value="3" />
        
        <!-- Параметры обновления -->
        <param name="update_factor_free" value="0.4" />
        <param name="update_factor_occupied" value="0.7" />
        <param name="map_update_distance_thresh" value="0.2" />
        <param name="map_update_angle_thresh" value="0.1" />
        
        <!-- Параметры сканирования -->
        <param name="laser_min_dist" value="0.1" />
        <param name="laser_max_dist" value="12.0" />
        <param name="laser_z_min_value" value="-1.0" />
        <param name="laser_z_max_value" value="1.0" />
    </node>

    <!-- Управление с клавиатуры -->
    <node pkg="turtlebot3_teleop" type="turtlebot3_teleop_key" name="teleop_keyboard" output="screen">
        <param name="model" value="$(arg model)"/>
    </node>

    <!-- Запуск RViz с конфигурацией для Hector -->
    <group if="$(arg rviz)">
        <node pkg="rviz" type="rviz" name="rviz" required="true"
              args="-d $(find super_blonda_study_pkg)/rviz/hector_mapping.rviz"/>
    </group>
</launch>
